{\rtf1\ansi\ansicpg1252\deff0\deflang1033{\fonttbl{\f0\fmodern Consolas;}{\f1\fmodern\fcharset0 Consolas;}{\f2\fnil\fcharset129 Courier New;}}
{\colortbl ;\red20\green20\blue20;\red142\green142\blue142;\red16\green158\blue98;\red148\green146\blue12;\red170\green51\blue170;\red170\green64\blue64;\red56\green136\blue159;}
\viewkind4\uc1\pard\f0\fs20 khoshino@discovery.usc.edu's password:\cf1\highlight2 
\par \cf0\highlight0     \u9484?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9488?\cf1\highlight2 
\par \cf0\highlight0     \u9474?                 \cf3\f1\bullet  MobaXterm Personal Edition v23.2 \bullet\cf0\f0                  \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?               \cf4 (SSH client, X server and network tools)\cf0                \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?                                                                      \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474? \u11166? SSH session to \cf5 khoshino@discovery.usc.edu                \cf0           \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?\f1    \bullet  Direct SSH      :  \cf3\f0\u10003?\cf0                                              \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?\f1    \bullet  SSH compression :  \cf6\f0\u10007?\cf0   (disabled or not supported by server)      \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?\f1    \bullet  SSH-browser     :  \cf3\f0\u10003?\cf0                                              \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?\f1    \bullet  X11-forwarding  :  \cf3\f0\u10003?\cf0   (remote display is forwarded through SSH)  \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474?                                                                      \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9474? \u11166? For more info, ctrl+click on \cf7\ul help\cf0\ulnone  or visit our \cf7\ul website\cf0\ulnone .            \u9474?\cf1\highlight2 
\par \cf0\highlight0     \u9492?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9472?\u9496?\cf1\highlight2 
\par 
\par \cf0\highlight0 Last login: Thu Jan 11 21:22:18 2024 from 10.21.33.157\cf1\highlight2 
\par \cf0\highlight0 ------------------------------------------------------------------------------\cf1\highlight2 
\par \cf0\highlight0          Welcome to the Center for Advanced Research Computing (CARC)\cf1\highlight2 
\par \cf0\highlight0                 at the University of Southern California (USC)\cf1\highlight2 
\par \cf0\highlight0 ------------------------------------------------------------------------------\cf1\highlight2 
\par 
\par \cf0\highlight0         CARC website : https://www.carc.usc.edu\cf1\highlight2 
\par \cf0\highlight0         User support : https://www.carc.usc.edu/user-support\cf1\highlight2 
\par \cf0\highlight0         User portal  : https://hpcaccount.usc.edu\cf1\highlight2 
\par 
\par \cf0\highlight0               ** Unauthorized use/access is prohibited **\cf1\highlight2 
\par 
\par \cf0\highlight0 If you log on to this computer system, you acknowledge your awareness of and\cf1\highlight2 
\par \cf0\highlight0 concurrence with the USC CARC Acceptable Use Policy. USC will prosecute\cf1\highlight2 
\par \cf0\highlight0 violators to the full extent of the law.\cf1\highlight2 
\par 
\par \cf0\highlight0 ------------------------------------------------------------------------------\cf1\highlight2 
\par \cf0\highlight0 Attention: Accessing the cluster via the Remote SSH extension of VS Code may\cf1\highlight2 
\par \cf0\highlight0 be blocked. Please use the SSH-FS extension instead.\cf1\highlight2 
\par \cf0\highlight0 ------------------------------------------------------------------------------\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 [khoshino@discovery1 ~]$ cd FedAvg\cf1\highlight2 
\par \cf0\highlight0 [khoshino@discovery1 FedAvg]$ conda activate f_avg\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@discovery1 FedAvg]$ salloc --partition=gpu --cpus-per-task=4 --mem=16G --gres=gpu:p100:1 --time=4:00:00\cf1\highlight2 
\par \cf0\highlight0 salloc: Pending job allocation 18519475\cf1\highlight2 
\par \cf0\highlight0 salloc: job 18519475 queued and waiting for resources\cf1\highlight2 
\par \cf0\highlight0 salloc: job 18519475 has been allocated resources\cf1\highlight2 
\par \cf0\highlight0 salloc: Granted job allocation 18519475\cf1\highlight2 
\par \cf0\highlight0 [khoshino@e21-16 FedAvg]$ python fed_avg_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epochs=1000                         --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #31 | Epoch: 19/20 | Loss: 0.13673977305491766 | Acc: 1.028\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.011478211196760336\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.0157079436840157 | Avg Test Accuracy: 0.2822\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2822\cf1\highlight2 
\par \cf0\highlight0 Client #42 | Epoch: 19/20 | Loss: 0.01918646724273761 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.006224649901657054\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 4.386164090572259 | Avg Test Accuracy: 0.131\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2822\cf1\highlight2 
\par \cf0\highlight0 Client #80 | Epoch: 19/20 | Loss: 0.0092284488491714 | Acc: 1.0.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.004311801679949793\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.259982414734669 | Avg Test Accuracy: 0.2323\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2822\cf1\highlight2 
\par \cf0\highlight0 Client #50 | Epoch: 19/20 | Loss: 0.0067459940910339355 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0033187045630378026\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.3797391867026305 | Avg Test Accuracy: 0.2414\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2822\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.18713662790697672, 0.125, 0.07776162790697672]\cf1\highlight2 
\par \cf0\highlight0 Client #93 | Epoch: 19/20 | Loss: 0.005626193480566144 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0027089634266061085\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.497006046466338 | Avg Test Accuracy: 0.3382\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3382\cf1\highlight2 
\par \cf0\highlight0 [0.19767441860465118, 0.14389534883720934, 0.10210755813953487, 0.06904069767441856]\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.004719317890703678 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0022938845861547935\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.3355021812976937 | Avg Test Accuracy: 0.3826\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3826\cf1\highlight2 
\par \cf0\highlight0 [0.1522529069767442, 0.11736918604651159, 0.08466569767441856, 0.062136627906976716]\cf1\highlight2 
\par \cf0\highlight0 Client #54 | Epoch: 19/20 | Loss: 0.0037580570206046104 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001992696538911245\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.0492255886395774 | Avg Test Accuracy: 0.4244\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4244\cf1\highlight2 
\par \cf0\highlight0 [0.12754360465116277, 0.0977470930232558, 0.07739825581395354, 0.0526889534883721]\cf1\highlight2 
\par \cf0\highlight0 Client #94 | Epoch: 19/20 | Loss: 0.003310051979497075 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0017643893401448924\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.082966997073247 | Avg Test Accuracy: 0.4382\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4382\cf1\highlight2 
\par \cf0\highlight0 [0.10973837209302328, 0.09084302325581395, 0.0741279069767442, 0.057412790697674465]\cf1\highlight2 
\par \cf0\highlight0 Client #33 | Epoch: 19/20 | Loss: 0.003133968294908603 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 9 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001585074810901898\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9630373257857103 | Avg Test Accuracy: 0.4597\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4597\cf1\highlight2 
\par \cf0\highlight0 [0.10101744186046513, 0.08430232558139539, 0.07194767441860461, 0.05050872093023251]\cf1\highlight2 
\par \cf0\highlight0 Client #61 | Epoch: 19/20 | Loss: 0.002657477317067484 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 10 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001440962005329008\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.8895882734885583 | Avg Test Accuracy: 0.4697\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4697\cf1\highlight2 
\par \cf0\highlight0 [0.09520348837209303, 0.08539244186046513, 0.06976744186046513, 0.04978197674418605]\cf1\highlight2 
\par \cf0\highlight0 [early_bird_30] Find EB!!!!!!!!!, epoch: 10\cf1\highlight2 
\par \cf0\highlight0 Client #37 | Epoch: 19/20 | Loss: 0.002301079143459598 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 11 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0013218881865032018\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5851896894283783 | Avg Test Accuracy: 0.5289\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5289\cf1\highlight2 
\par \cf0\highlight0 [0.09556686046511631, 0.08175872093023251, 0.0664970930232558, 0.047238372093023284]\cf1\highlight2 
\par \cf0\highlight0 Client #34 | Epoch: 19/20 | Loss: 0.002325881738215685 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 12 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0012218671456018153\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.627120418426318 | Avg Test Accuracy: 0.5328\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5328\cf1\highlight2 
\par \cf0\highlight0 [0.08938953488372092, 0.07376453488372092, 0.059229651162790664, 0.04033430232558144]\cf1\highlight2 
\par \cf0\highlight0 Client #45 | Epoch: 19/20 | Loss: 0.002295453140201668 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 13 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0011366908734915062\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5743085100100591 | Avg Test Accuracy: 0.5365\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5365\cf1\highlight2 
\par \cf0\highlight0 [0.08684593023255816, 0.07340116279069764, 0.061046511627906974, 0.04433139534883723]\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #66 | Epoch: 19/20 | Loss: 0.001792108523659408 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 14 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0010627946332152488\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.500320587402735 | Avg Test Accuracy: 0.5704\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5704\cf1\highlight2 
\par \cf0\highlight0 [0.07994186046511631, 0.06867732558139539, 0.055595930232558155, 0.0370639534883721]\cf1\highlight2 
\par \cf0\highlight0 Client #96 | Epoch: 19/20 | Loss: 0.0017991859543447692 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 15 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0009984612801733116\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5567490336222527 | Avg Test Accuracy: 0.5535\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5704\cf1\highlight2 
\par \cf0\highlight0 [0.07630813953488369, 0.06431686046511631, 0.051962209302325535, 0.04142441860465118]\cf1\highlight2 
\par \cf0\highlight0 Client #24 | Epoch: 19/20 | Loss: 0.0018186224236463506 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 16 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0009419201801695939\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.4310564994812012 | Avg Test Accuracy: 0.5836\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5836\cf1\highlight2 
\par \cf0\highlight0 [0.0741279069767442, 0.0625, 0.05523255813953487, 0.0410610465116279]\cf1\highlight2 
\par \cf0\highlight0 Client #17 | Epoch: 19/20 | Loss: 0.001383090120119353 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 17 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.000891443766863542\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.4755498919731531 | Avg Test Accuracy: 0.5785\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5836\cf1\highlight2 
\par \cf0\highlight0 [0.07085755813953487, 0.06540697674418605, 0.05341569767441856, 0.03379360465116277]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):714118401209514 | Acc: 0.682.0\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 315, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 220, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 116, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __call__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 134, in __call__\cf1\highlight2 
\par \cf0\highlight0     return F.to_tensor(pic)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 164, in to_tensor\cf1\highlight2 
\par \cf0\highlight0     img = torch.from_numpy(np.array(pic, mode_to_nptype.get(pic.mode, np.uint8), copy=True))\cf1\highlight2 
\par \cf0\highlight0 TypeError: int() argument must be a string, a bytes-like object or a number, not 'Image'\cf1\highlight2 
\par \cf0\highlight0 [khoshino@e21-16 FedAvg]$ conda activate f_avg\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epoc                        hs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #96 | Epoch: 19/20 | Loss: 0.34781454503536224 | Acc: 1.084\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.012936617595454055\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9636190212689912 | Avg Test Accuracy: 0.3088\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3088\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):057590961456299 | Acc: 0.56.0\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 315, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 220, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 125, in _train_client\cf1\highlight2 
\par \cf0\highlight0     epoch_loss += loss.item()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epoc                        hs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #63 | Epoch: 19/20 | Loss: 0.21168444802363715 | Acc: 1.088\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.010957881361246109\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9955923511431768 | Avg Test Accuracy: 0.2959\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2959\cf1\highlight2 
\par \cf0\highlight0 Client #94 | Epoch: 19/20 | Loss: 0.019013163323203724 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005948067044373602\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.369198215313447 | Avg Test Accuracy: 0.1805\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2959\cf1\highlight2 
\par \cf0\highlight0 Client #24 | Epoch: 19/20 | Loss: 0.00916133743400375 | Acc: 1.008\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.00412590154265571\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.9054674827135525 | Avg Test Accuracy: 0.251\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2959\cf1\highlight2 
\par \cf0\highlight0 Client #87 | Epoch: 19/20 | Loss: 0.006514940566072862 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0031782908235133316\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.3993739730272536 | Avg Test Accuracy: 0.3218\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3218\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.19585755813953487, 0.13408430232558144, 0.0821220930232558]\cf1\highlight2 
\par \cf0\highlight0 Client #57 | Epoch: 19/20 | Loss: 0.005412687469894688 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002594978920184076\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.0975788220381126 | Avg Test Accuracy: 0.4014\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4014\cf1\highlight2 
\par \cf0\highlight0 [0.2071220930232558, 0.15079941860465118, 0.10973837209302328, 0.06468023255813948]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):007583433762192726 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 315, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 220, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 116, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __call__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 269, in forward\cf1\highlight2 
\par \cf0\highlight0     return F.normalize(tensor, self.mean, self.std, self.inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 360, in normalize\cf1\highlight2 
\par \cf0\highlight0     return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional_tensor.py", line 953, in normal                        ize\cf1\highlight2 
\par \cf0\highlight0     if (std == 0).any():\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=10                                  0 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #48 | Epoch: 19/20 | Loss: 0.19628231972455978 | Acc: 1.026\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.009794625168045362\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9787648488313725 | Avg Test Accuracy: 0.2975\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2975\cf1\highlight2 
\par \cf0\highlight0 Client #8 | Epoch: 19/20 | Loss: 0.017656467234094936 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.00535226544054846\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.331454405417809 | Avg Test Accuracy: 0.1913\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2975\cf1\highlight2 
\par \cf0\highlight0 Client #79 | Epoch: 19/20 | Loss: 0.009358565788716078 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0037259283643733296\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.536424071360857 | Avg Test Accuracy: 0.2966\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2975\cf1\highlight2 
\par \cf0\highlight0 Client #67 | Epoch: 19/20 | Loss: 0.006621077501525481 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0028748617173793415\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.5475532030447936 | Avg Test Accuracy: 0.3013\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3013\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.1856831395348837, 0.12245639534883723, 0.08248546511627908]\cf1\highlight2 
\par \cf0\highlight0 Client #81 | Epoch: 19/20 | Loss: 0.004952402863030632 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0023499793134784943\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.1722954435226245 | Avg Test Accuracy: 0.3799\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3799\cf1\highlight2 
\par \cf0\highlight0 [0.19476744186046513, 0.1369912790697675, 0.10138081395348841, 0.06431686046511631]\cf1\highlight2 
\par \cf0\highlight0 Client #39 | Epoch: 19/20 | Loss: 0.0033291877868274846 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001992419648514543\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9674102740410047 | Avg Test Accuracy: 0.4235\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4235\cf1\highlight2 
\par \cf0\highlight0 [0.15370639534883723, 0.11809593023255816, 0.08829941860465118, 0.05523255813953487]\cf1\highlight2 
\par \cf0\highlight0 Client #12 | Epoch: 19/20 | Loss: 0.0038037681176016727 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001733026329311542\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7571141826800811 | Avg Test Accuracy: 0.4717\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4717\cf1\highlight2 
\par \cf0\highlight0 [0.12718023255813948, 0.10210755813953487, 0.07630813953488369, 0.05850290697674421]\cf1\highlight2 
\par \cf0\highlight0 Client #44 | Epoch: 19/20 | Loss: 0.0033726385639359555 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001536529080525118\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7934756523523576 | Avg Test Accuracy: 0.4714\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4717\cf1\highlight2 
\par \cf0\highlight0 [0.11228197674418605, 0.09302325581395354, 0.07885174418604646, 0.05486918604651159]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):1670183924337228 | Acc: 1.0060\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 316, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 221, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 116, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_dat                                  a\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcom                                  p>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem_                                  _\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __ca                                  ll__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 269, in for                                  ward\cf1\highlight2 
\par \cf0\highlight0     return F.normalize(tensor, self.mean, self.std, self.inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 360, in nor                                  malize\cf1\highlight2 
\par \cf0\highlight0     return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional_tensor.py", line 948,                                   in normalize\cf1\highlight2 
\par \cf0\highlight0     tensor = tensor.clone()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=10                                  0 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 15, in <module>\cf1\highlight2 
\par \cf0\highlight0     from utils import arg_parser, average_weights, Logger\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/utils.py", line 6, in <module>\cf1\highlight2 
\par \cf0\highlight0     import wandb\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/__init__.py", line 26, in <module>\cf1\highlight2 
\par \cf0\highlight0     from wandb import sdk as wandb_sdk\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/__init__.py", line 7, in <module>\cf1\highlight2 
\par \cf0\highlight0     from .wandb_init import _attach, init  # noqa: F401\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/wandb_init.py", line 31, in <module>\cf1\highlight2 
\par \cf0\highlight0     from .backend.backend import Backend\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/backend/backend.py", line 20, in <module>\cf1\highlight2 
\par \cf0\highlight0     from ..internal.internal import wandb_internal\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/internal/internal.py", line 34, in <module>\cf1\highlight2 
\par \cf0\highlight0     from . import context, handler, internal_util, sender, settings_static, writer\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/internal/handler.py", line 40, in <module>\cf1\highlight2 
\par \cf0\highlight0     from .system.system_monitor import SystemMonitor\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/internal/system/system_monitor.py", line 7, i                                  n <module>\cf1\highlight2 
\par \cf0\highlight0     from .assets.asset_registry import asset_registry\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/wandb/sdk/internal/system/assets/__init__.py", line 4,                                   in <module>\cf1\highlight2 
\par \cf0\highlight0     from .gpu import GPU  # noqa: F401\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap>", line 1007, in _find_and_load\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap>", line 986, in _find_and_load_unlocked\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap>", line 680, in _load_unlocked\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap_external>", line 846, in exec_module\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap_external>", line 935, in get_code\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap_external>", line 1079, in path_stats\cf1\highlight2 
\par \cf0\highlight0   File "<frozen importlib._bootstrap_external>", line 142, in _path_stat\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=10                                  0 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #40 | Epoch: 19/20 | Loss: 0.13911747684081396 | Acc: 1.02\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.010467511427899203\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9741596778233845 | Avg Test Accuracy: 0.2902\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2902\cf1\highlight2 
\par \cf0\highlight0 Client #64 | Epoch: 19/20 | Loss: 0.017240827903151512 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005687327242145936\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.0609123003788485 | Avg Test Accuracy: 0.1927\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2902\cf1\highlight2 
\par \cf0\highlight0 Client #18 | Epoch: 19/20 | Loss: 0.009549799530456463 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.003952209012738119\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.856734016002753 | Avg Test Accuracy: 0.2384\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2902\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.006557584274560213 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0030471438867971305\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.602674044095553 | Avg Test Accuracy: 0.2938\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2938\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.19313226744186052, 0.1286337209302325, 0.08103197674418605]\cf1\highlight2 
\par \cf0\highlight0 Client #73 | Epoch: 19/20 | Loss: 0.0053185100356737776 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002488087700757509\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.359043381153009 | Avg Test Accuracy: 0.34\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.34\cf1\highlight2 
\par \cf0\highlight0 [0.20257994186046513, 0.14789244186046513, 0.10428779069767447, 0.06976744186046513]\cf1\highlight2 
\par \cf0\highlight0 Client #16 | Epoch: 19/20 | Loss: 0.004345466538021962 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0021090726905579993\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.025173367598118 | Avg Test Accuracy: 0.4022\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4022\cf1\highlight2 
\par \cf0\highlight0 [0.16097383720930236, 0.1210029069767442, 0.09629360465116277, 0.06613372093023251]\cf1\highlight2 
\par \cf0\highlight0 Client #36 | Epoch: 19/20 | Loss: 0.003946889579916994 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0018344024209017381\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9691879917413762 | Avg Test Accuracy: 0.4258\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4258\cf1\highlight2 
\par \cf0\highlight0 [0.12354651162790697, 0.11010174418604646, 0.08575581395348841, 0.061046511627906974]\cf1\highlight2 
\par \cf0\highlight0 Client #6 | Epoch: 19/20 | Loss: 0.0030668536201119423 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0016257561309127296\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.880934747365805 | Avg Test Accuracy: 0.4515\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4515\cf1\highlight2 
\par \cf0\highlight0 [0.11882267441860461, 0.09883720930232553, 0.07994186046511631, 0.057412790697674465]\cf1\highlight2 
\par \cf0\highlight0 Client #69 | Epoch: 19/20 | Loss: 0.003054570018624266 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 9 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0014613110012659393\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.8053641533240294 | Avg Test Accuracy: 0.4756\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4756\cf1\highlight2 
\par \cf0\highlight0 [0.10792151162790697, 0.09011627906976749, 0.07340116279069764, 0.05523255813953487]\cf1\highlight2 
\par \cf0\highlight0 Client #17 | Epoch: 19/20 | Loss: 0.002821951910542945 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 10 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001328547764918767\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7640023414905255 | Avg Test Accuracy: 0.4865\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4865\cf1\highlight2 
\par \cf0\highlight0 [0.10210755813953487, 0.08866279069767447, 0.06795058139534882, 0.05123546511627908]\cf1\highlight2 
\par \cf0\highlight0 Client #19 | Epoch: 19/20 | Loss: 0.0026132746522004404 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 11 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001219330372881483\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.6399622651246877 | Avg Test Accuracy: 0.5159\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5159\cf1\highlight2 
\par \cf0\highlight0 [0.09447674418604646, 0.0839389534883721, 0.06976744186046513, 0.046875]\cf1\highlight2 
\par \cf0\highlight0 [early_bird_30] Find EB!!!!!!!!!, epoch: 11\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):0027273109881207347 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 316, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 221, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_.py", line 116, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_dat                                  a\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcom                                  p>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem_                                  _\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __ca                                  ll__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 269, in for                                  ward\cf1\highlight2 
\par \cf0\highlight0     return F.normalize(tensor, self.mean, self.std, self.inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 360, in nor                                  malize\cf1\highlight2 
\par \cf0\highlight0     return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional_tensor.py", line 953,                                   in normalize\cf1\highlight2 
\par \cf0\highlight0     if (std == 0).any():\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Traceback (most recent call last):0.21454741060733795 | Acc: 1.088\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 318, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 241, in train\cf1\highlight2 
\par \cf0\highlight0     self.save_checkpoint(\{\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 150, in save_checkpoint\cf1\highlight2 
\par \cf0\highlight0     full_file_path = os.path.join(filepath, filename)\cf1\highlight2 
\par \cf0\highlight0 UnboundLocalError: local variable 'filename' referenced before assignment\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 150\cf1\highlight2 
\par \cf0\highlight0     full_file_path = os.path.join(filepath, filename)\cf1\highlight2 
\par \cf0\highlight0                                                      ^\cf1\highlight2 
\par \cf0\highlight0 IndentationError: unindent does not match any outer indentation level\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 saving the new best model...Loss: 0.3069288680950801 | Acc: 1.008\cf1\highlight2 
\par \cf0\highlight0 Traceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 318, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 241, in train\cf1\highlight2 
\par \cf0\highlight0     self.save_checkpoint(\{\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 155, in save_checkpoint\cf1\highlight2 
\par \cf0\highlight0     shutil.copyfile(full_file_path, os.path.join(filepath, 'model_best.pth.tar'))\cf1\highlight2 
\par \cf0\highlight0 UnboundLocalError: local variable 'full_file_path' referenced before assignment\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 saving the new best model...Loss: 0.23434451719125113 | Acc: 1.066\cf1\highlight2 
\par \cf0\highlight0 Traceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 319, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 242, in train\cf1\highlight2 
\par \cf0\highlight0     self.save_checkpoint(\{\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 156, in save_checkpoint\cf1\highlight2 
\par \cf0\highlight0     shutil.copyfile(full_file_path, os.path.join(filepath, 'model_best.pth.tar'))\cf1\highlight2 
\par \cf0\highlight0 UnboundLocalError: local variable 'full_file_path' referenced before assignment\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 saving the new best model...Loss: 0.36548979580402374 | Acc: 1.068\cf1\highlight2 
\par \cf0\highlight0 Traceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 321, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 244, in train\cf1\highlight2 
\par \cf0\highlight0     self.save_checkpoint(\{\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 158, in save_checkpoint\cf1\highlight2 
\par \cf0\highlight0     shutil.copyfile(full_file_path, os.path.join(filepath, 'model_best.pth.tar'))\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/shutil.py", line 264, in copyfile\cf1\highlight2 
\par \cf0\highlight0     with open(src, 'rb') as fsrc:\cf1\highlight2 
\par \cf0\highlight0 FileNotFoundError: [Errno 2] No such file or directory: './logs/ckpt0.pth.tar'\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.356182724237442 | Acc: 1.09868\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.014445830459396045\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.043263235153296 | Avg Test Accuracy: 0.26\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.26\cf1\highlight2 
\par \cf0\highlight0 Client #24 | Epoch: 19/20 | Loss: 0.02012478094547987 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.007742492318308602\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.307179230910081 | Avg Test Accuracy: 0.1855\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.26\cf1\highlight2 
\par \cf0\highlight0 Client #3 | Epoch: 19/20 | Loss: 0.009877359649787346 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005327901986634566\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.8008004304690237 | Avg Test Accuracy: 0.2527\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.26\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.00657602787638704 | Acc: 1.000\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0040807613887591295\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.2539211007264943 | Avg Test Accuracy: 0.3445\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3445\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.19840116279069764, 0.12827034883720934, 0.08284883720930236]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.005407256384690602 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0033157696474809205\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.098877970988934 | Avg Test Accuracy: 0.3846\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3846\cf1\highlight2 
\par \cf0\highlight0 [0.20239825581395354, 0.14207848837209303, 0.0995639534883721, 0.06322674418604646]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.004960775685807069 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002800578163328788\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9904284675916035 | Avg Test Accuracy: 0.4175\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4175\cf1\highlight2 
\par \cf0\highlight0 [0.1580668604651163, 0.11773255813953487, 0.09193313953488369, 0.07158430232558144]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.0036934256398429475 | Acc: 1.0\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002426812209388508\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.8231161282612727 | Avg Test Accuracy: 0.4616\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4616\cf1\highlight2 
\par \cf0\highlight0 [0.13317587209302328, 0.1113735465116279, 0.09393168604651159, 0.05941133720930236]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.0031232479183624187 | Acc: 1.0\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0021447508610193235\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5280353732598133 | Avg Test Accuracy: 0.5278\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5278\cf1\highlight2 
\par \cf0\highlight0 [0.11954941860465118, 0.10683139534883723, 0.07885174418604646, 0.05287063953488369]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):07947602619727453 | Acc: 1.098\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 317, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 219, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 115, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_dat                                  a\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcom                                  p>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem_                                  _\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __ca                                  ll__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 134, in __c                                  all__\cf1\highlight2 
\par \cf0\highlight0     return F.to_tensor(pic)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 170, in to_                                  tensor\cf1\highlight2 
\par \cf0\highlight0     img = img.permute((2, 0, 1)).contiguous()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.22115769982337952 | Acc: 1.082\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.011086939026912053\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9995858195500495 | Avg Test Accuracy: 0.2779\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2779\cf1\highlight2 
\par \cf0\highlight0 Client #19 | Epoch: 19/20 | Loss: 0.017841770313680172 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005995967048220336\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.638931100185101 | Avg Test Accuracy: 0.1805\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2779\cf1\highlight2 
\par \cf0\highlight0 Client #23 | Epoch: 19/20 | Loss: 0.0094270760503908 | Acc: 1.000\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.004153264028589345\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.8617686858543983 | Avg Test Accuracy: 0.2434\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2779\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.006454035794983308 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.00319540444528684\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.648374762290563 | Avg Test Accuracy: 0.2962\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2962\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.1951308139534884, 0.1309956395348837, 0.0839389534883721]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.005406957818195224 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0026084521025574454\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.6318309811445384 | Avg Test Accuracy: 0.3062\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3062\cf1\highlight2 
\par \cf0\highlight0 [0.20748546511627908, 0.14807412790697672, 0.10683139534883723, 0.0683139534883721]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.003989408956840634 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002207620263345436\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.07637533163413 | Avg Test Accuracy: 0.402\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.402\cf1\highlight2 
\par \cf0\highlight0 [0.1600654069767442, 0.1191860465116279, 0.08539244186046513, 0.061046511627906974]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.003206698146338264 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0019181543913492488\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9583157438498278 | Avg Test Accuracy: 0.4237\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4237\cf1\highlight2 
\par \cf0\highlight0 [0.13353924418604646, 0.10265261627906974, 0.0819404069767442, 0.056140988372093026]\cf1\highlight2 
\par \cf0\highlight0 Client #9 | Epoch: 19/20 | Loss: 0.0034484269563108683 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0016987397361178107\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.1222981336789255 | Avg Test Accuracy: 0.4121\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4237\cf1\highlight2 
\par \cf0\highlight0 [0.11010174418604646, 0.09556686046511631, 0.07776162790697672, 0.057957848837209336]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.0025434454437345266 | Acc: 1.0\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 9 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0015259193246149353\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7799228093562982 | Avg Test Accuracy: 0.479\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.479\cf1\highlight2 
\par \cf0\highlight0 [0.10792151162790697, 0.08829941860465118, 0.07285610465116277, 0.04905523255813948]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.0025466975833599768 | Acc: 1.0\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 10 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001385794795991387\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7182697225839665 | Avg Test Accuracy: 0.495\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.495\cf1\highlight2 
\par \cf0\highlight0 [0.09920058139534882, 0.08448401162790697, 0.0664970930232558, 0.04760174418604646]\cf1\highlight2 
\par \cf0\highlight0 [early_bird_30] Find EB!!!!!!!!!, epoch: 10\cf1\highlight2 
\par \cf0\highlight0 Saving Early Bird checkpoint for epoch EB-30-10...\cf1\highlight2 
\par \cf0\highlight0 Client #88 | Epoch: 19/20 | Loss: 0.0025857132859528065 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 11 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001271387641000646\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.867436836927365 | Avg Test Accuracy: 0.4791\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.495\cf1\highlight2 
\par \cf0\highlight0 [0.09683866279069764, 0.07848837209302328, 0.06577034883720934, 0.05341569767441856]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model...Loss: 0.0023548462195321918 | Acc: 1.0\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 12 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0011748557478454635\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5904762622637627 | Avg Test Accuracy: 0.5249\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5249\cf1\highlight2 
\par \cf0\highlight0 [0.09011627906976749, 0.07521802325581395, 0.0664970930232558, 0.04760174418604646]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):01748342610274752 | Acc: 1.000\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 323, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 225, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 119, in _train_client\cf1\highlight2 
\par \cf0\highlight0     logits = model(data)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/models/models.py", line 91, in forward\cf1\highlight2 
\par \cf0\highlight0     x = self.feature(x)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/container.py", line 139, in forward\cf1\highlight2 
\par \cf0\highlight0     input = module(input)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/batchnorm.py", line 168, in forward\cf1\highlight2 
\par \cf0\highlight0     return F.batch_norm(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/functional.py", line 2438, in batch_norm\cf1\highlight2 
\par \cf0\highlight0     return torch.batch_norm(\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 0...68169220288595 | Acc: 1.042\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.010251275934278966\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9379995190180266 | Avg Test Accuracy: 0.3134\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3134\cf1\highlight2 
\par \cf0\highlight0 Client #8 | Epoch: 19/20 | Loss: 0.018173254715899628 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005587572194635868\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.862366572404519 | Avg Test Accuracy: 0.2309\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3134\cf1\highlight2 
\par \cf0\highlight0 Client #67 | Epoch: 19/20 | Loss: 0.009085472207516432 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0038889279384683403\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.6591298243938346 | Avg Test Accuracy: 0.264\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3134\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 3...671668495982885 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0030017088549599675\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9580749349716382 | Avg Test Accuracy: 0.3852\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3852\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.1838662790697675, 0.12609011627906974, 0.08321220930232553]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 4...434150652339061 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0024531196938672416\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.84724795512664 | Avg Test Accuracy: 0.4333\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4333\cf1\highlight2 
\par \cf0\highlight0 [0.1991279069767442, 0.13808139534883723, 0.10138081395348841, 0.06686046511627908]\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 5...016130696982145 | Acc: 1.00\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0020799165372995454\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7436872934683776 | Avg Test Accuracy: 0.4646\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4646\cf1\highlight2 
\par \cf0\highlight0 [0.1504360465116279, 0.11736918604651159, 0.08611918604651159, 0.06031976744186052]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):003931638163824876 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 328, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 230, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 124, in _train_client\cf1\highlight2 
\par \cf0\highlight0     epoch_loss += loss.item()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch \{epoch\}...64227295 | Acc: 1.08\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.010121435324350992\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9800901519946563 | Avg Test Accuracy: 0.3124\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3124\cf1\highlight2 
\par \cf0\highlight0 Client #42 | Epoch: 19/20 | Loss: 0.018140243055919807 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005510277913417667\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.1522647448075123 | Avg Test Accuracy: 0.1989\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3124\cf1\highlight2 
\par \cf0\highlight0 Client #9 | Epoch: 19/20 | Loss: 0.009468302285919586 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.003830638520885259\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.3884730277917323 | Avg Test Accuracy: 0.303\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3124\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch \{epoch\}...806767781 | Acc: 1.08\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002952988889689247\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.1206167309712143 | Avg Test Accuracy: 0.3689\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3689\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.18640988372093026, 0.1289970930232558, 0.07776162790697672]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):2157542109489441 | Acc: 1.0920\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 392, in _getdecoder\cf1\highlight2 
\par \cf0\highlight0     decoder = DECODERS[decoder_name]\cf1\highlight2 
\par \cf0\highlight0 KeyError: 'raw'\cf1\highlight2 
\par 
\par \cf0\highlight0 During handling of the above exception, another exception occurred:\cf1\highlight2 
\par 
\par \cf0\highlight0 Traceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 323, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 225, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 115, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_dat                                  a\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcom                                  p>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 115, in __getitem_                                  _\cf1\highlight2 
\par \cf0\highlight0     img = Image.fromarray(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2974, in fromarray\cf1\highlight2 
\par \cf0\highlight0     return frombuffer(mode, size, obj, "raw", rawmode, 0, 1)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2901, in frombuffer\cf1\highlight2 
\par \cf0\highlight0     return frombytes(mode, size, data, decoder_name, args)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2843, in frombytes\cf1\highlight2 
\par \cf0\highlight0     im.frombytes(data, decoder_name, args)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 793, in frombytes\cf1\highlight2 
\par \cf0\highlight0     d = _getdecoder(self.mode, decoder_name, args)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 392, in _getdecoder\cf1\highlight2 
\par \cf0\highlight0     decoder = DECODERS[decoder_name]\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #71 | Epoch: 19/20 | Loss: 0.21594804525375366 | Acc: 1.04\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 0...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.019085320532321932\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.12935165869884 | Avg Test Accuracy: 0.2439\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2439\cf1\highlight2 
\par \cf0\highlight0 Client #56 | Epoch: 19/20 | Loss: 0.021743287953237694 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.01010729547822848\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 4.075696801527952 | Avg Test Accuracy: 0.1562\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2439\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):23692946881055832 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 323, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 225, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 124, in _train_client\cf1\highlight2 
\par \cf0\highlight0     epoch_loss += loss.item()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_                                  clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #38 | Epoch: 19/20 | Loss: 0.22783179581165314 | Acc: 1.086\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 0...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0100433212146163\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9877246801669781 | Avg Test Accuracy: 0.2809\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2809\cf1\highlight2 
\par \cf0\highlight0 Client #20 | Epoch: 19/20 | Loss: 0.018380438908934593 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005473668223712594\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.9012437906020727 | Avg Test Accuracy: 0.2292\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2809\cf1\highlight2 
\par \cf0\highlight0 Client #76 | Epoch: 19/20 | Loss: 0.010082318757971128 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.003807727746768958\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.740692988420144 | Avg Test Accuracy: 0.2555\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2809\cf1\highlight2 
\par \cf0\highlight0 Client #94 | Epoch: 19/20 | Loss: 0.006845861052473386 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 3...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002937087634733568\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.5021849305201798 | Avg Test Accuracy: 0.3137\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3137\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.18895348837209303, 0.12827034883720934, 0.08030523255813948]\cf1\highlight2 
\par \cf0\highlight0 Client #17 | Epoch: 19/20 | Loss: 0.004757320042699575 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 4...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002401813482632861\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.207606552503048 | Avg Test Accuracy: 0.3645\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3645\cf1\highlight2 
\par \cf0\highlight0 [0.19767441860465118, 0.14135174418604646, 0.1035610465116279, 0.06577034883720934]\cf1\highlight2 
\par \cf0\highlight0 Client #89 | Epoch: 19/20 | Loss: 0.0050670073833316565 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 5...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0020388726042842287\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.8393329611191382 | Avg Test Accuracy: 0.4363\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4363\cf1\highlight2 
\par \cf0\highlight0 [0.15625, 0.11991279069767447, 0.08829941860465118, 0.061046511627906974]\cf1\highlight2 
\par \cf0\highlight0 Client #83 | Epoch: 19/20 | Loss: 0.0039289752797534066 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 6...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0017758135398339835\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.6420532617813501 | Avg Test Accuracy: 0.4887\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4887\cf1\highlight2 
\par \cf0\highlight0 [0.13008720930232553, 0.10247093023255816, 0.07630813953488369, 0.04796511627906974]\cf1\highlight2 
\par \cf0\highlight0 Client #52 | Epoch: 19/20 | Loss: 0.0034784235370655856 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001574429829440002\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.700652192800473 | Avg Test Accuracy: 0.4857\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4887\cf1\highlight2 
\par \cf0\highlight0 [0.11228197674418605, 0.0879360465116279, 0.0683139534883721, 0.047238372093023284]\cf1\highlight2 
\par \cf0\highlight0 Client #65 | Epoch: 19/20 | Loss: 0.003355615772306919 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 8...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 9 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001416550079916811\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5764473676681519 | Avg Test Accuracy: 0.5128\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5128\cf1\highlight2 
\par \cf0\highlight0 [0.10101744186046513, 0.08030523255813948, 0.06177325581395354, 0.04760174418604646]\cf1\highlight2 
\par \cf0\highlight0 Client #25 | Epoch: 19/20 | Loss: 0.0027464753560100994 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 9...\cf1\highlight2 
\par \cf0\highlight0 !\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 10 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001288402492607323\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5487014513749342 | Avg Test Accuracy: 0.5315\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5315\cf1\highlight2 
\par \cf0\highlight0 [0.09411337209302328, 0.07703488372093026, 0.06395348837209303, 0.048328488372093026]\cf1\highlight2 
\par \cf0\highlight0 [early_bird_30] Find EB!!!!!!!!!, epoch: 10\cf1\highlight2 
\par \cf0\highlight0 Saving Early Bird checkpoint for epoch EB-30-10...\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):002842086056868235 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 323, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 225, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird.py", line 115, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_dat                                  a\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcom                                  p>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 115, in __getitem_                                  _\cf1\highlight2 
\par \cf0\highlight0     img = Image.fromarray(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2970, in fromarray\cf1\highlight2 
\par \cf0\highlight0     obj = obj.tobytes()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n                                  _clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):7199960947036743 | Acc: 0.838\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 285, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 203, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 127, in _train_client\cf1\highlight2 
\par \cf0\highlight0     optimizer.step()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/optim/optimizer.py", line 113, in wrapper\cf1\highlight2 
\par \cf0\highlight0     return func(*args, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/autograd/grad_mode.py", line 27, in decorate_cont                                  ext\cf1\highlight2 
\par \cf0\highlight0     return func(*args, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/optim/sgd.py", line 136, in step\cf1\highlight2 
\par \cf0\highlight0     d_p_list.append(p.grad)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/_tensor.py", line 1079, in grad\cf1\highlight2 
\par \cf0\highlight0     if has_torch_function_unary(self):\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n                                  _clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #5 | Epoch: 19/20 | Loss: 0.35077498356501263 | Acc: 1.0846\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 0...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.015219806705911956\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9542875503882384 | Avg Test Accuracy: 0.3013\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3013\cf1\highlight2 
\par \cf0\highlight0 Client #95 | Epoch: 19/20 | Loss: 0.01948345173150301 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.008098086050401132\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.2747536928225784 | Avg Test Accuracy: 0.1742\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3013\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.009384029700110355 | Acc: 1.08\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.005563334876981875\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.754465748102237 | Avg Test Accuracy: 0.2399\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3013\cf1\highlight2 
\par \cf0\highlight0 Client #55 | Epoch: 19/20 | Loss: 0.006291860869775216 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.004254855463514105\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.719379675694001 | Avg Test Accuracy: 0.2848\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3013\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.19476744186046513, 0.12936046511627908, 0.07558139534883723]\cf1\highlight2 
\par \cf0\highlight0 Client #52 | Epoch: 19/20 | Loss: 0.0054813530296087265 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 4...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0034568917100938658\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.209362505338131 | Avg Test Accuracy: 0.3565\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3565\cf1\highlight2 
\par \cf0\highlight0 [0.20421511627906974, 0.1464389534883721, 0.10210755813953487, 0.06904069767441856]\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.0038883460219949484 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 5...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0029176649704135745\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.010083793065487 | Avg Test Accuracy: 0.4227\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4227\cf1\highlight2 
\par \cf0\highlight0 [0.1602470930232558, 0.11664244186046513, 0.08829941860465118, 0.06140988372093026]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):40213181947668396 | Acc: 0.998\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 285, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 203, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 120, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_dat                                  a\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcom                                  p>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem_                                  _\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __ca                                  ll__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 134, in __c                                  all__\cf1\highlight2 
\par \cf0\highlight0     return F.to_tensor(pic)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 170, in to_                                  tensor\cf1\highlight2 
\par \cf0\highlight0     img = img.permute((2, 0, 1)).contiguous()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n                                  _clients=100 --n_epochs=1000 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #34 | Epoch: 19/20 | Loss: 0.48759056131045025 | Acc: 0.988\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 0...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.020009621952970822\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.052707560551472 | Avg Test Accuracy: 0.2647\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2647\cf1\highlight2 
\par \cf0\highlight0 Client #74 | Epoch: 19/20 | Loss: 0.021491534697512787 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.01054940292922159\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.8190153562105618 | Avg Test Accuracy: 0.2283\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2647\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.01011497899889946 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.007206818262477301\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.1248334371126614 | Avg Test Accuracy: 0.2143\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2647\cf1\highlight2 
\par \cf0\highlight0 Client #52 | Epoch: 19/20 | Loss: 0.007211026735603809 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 3...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0054933919324927655\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.514768585180625 | Avg Test Accuracy: 0.308\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.308\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.19876453488372092, 0.13771802325581395, 0.07757994186046513]\cf1\highlight2 
\par \cf0\highlight0 Client #46 | Epoch: 19/20 | Loss: 0.005476232074821989 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 4...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.00444917796078759\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.0620378271127358 | Avg Test Accuracy: 0.3882\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3882\cf1\highlight2 
\par \cf0\highlight0 [0.21184593023255816, 0.1638808139534884, 0.10955668604651159, 0.07376453488372092]\cf1\highlight2 
\par \cf0\highlight0 Client #33 | Epoch: 19/20 | Loss: 0.004373925660426418 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 5...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0037444481941121114\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.0197240939507117 | Avg Test Accuracy: 0.418\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.418\cf1\highlight2 
\par \cf0\highlight0 [0.17260174418604646, 0.12409156976744184, 0.09375, 0.06395348837209303]\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.0037682787515223026 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 6...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.003235660571372137\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.979103195361602 | Avg Test Accuracy: 0.4285\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4285\cf1\highlight2 
\par \cf0\highlight0 [0.1386264534883721, 0.11010174418604646, 0.08248546511627908, 0.05523255813953487]\cf1\highlight2 
\par \cf0\highlight0 Client #42 | Epoch: 19/20 | Loss: 0.0031475822906941175 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 7...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0028520161949078713\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.8423870649093237 | Avg Test Accuracy: 0.4582\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4582\cf1\highlight2 
\par \cf0\highlight0 [0.12754360465116277, 0.10210755813953487, 0.07921511627906974, 0.06431686046511631]\cf1\highlight2 
\par \cf0\highlight0 Client #52 | Epoch: 19/20 | Loss: 0.002954633596042792 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 8...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 9 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0025514020011717185\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7717834206727834 | Avg Test Accuracy: 0.4846\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4846\cf1\highlight2 
\par \cf0\highlight0 [0.11082848837209303, 0.09484011627906974, 0.07921511627906974, 0.0566860465116279]\cf1\highlight2 
\par \cf0\highlight0 Client #96 | Epoch: 19/20 | Loss: 0.0030664400352785983 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 9...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 10 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0023101716397019726\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.7833886650892405 | Avg Test Accuracy: 0.49\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.49\cf1\highlight2 
\par \cf0\highlight0 [0.10392441860465118, 0.09120639534883723, 0.07267441860465118, 0.05450581395348841]\cf1\highlight2 
\par \cf0\highlight0 Client #99 | Epoch: 19/20 | Loss: 0.002611444292900463 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 10...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 11 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002111885156676484\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5829369395207136 | Avg Test Accuracy: 0.5231\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5231\cf1\highlight2 
\par \cf0\highlight0 [0.10065406976744184, 0.08466569767441856, 0.07049418604651159, 0.04505813953488369]\cf1\highlight2 
\par \cf0\highlight0 Client #62 | Epoch: 19/20 | Loss: 0.0022040450324614844 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 11...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 12 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001945487985018796\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5214462540088556 | Avg Test Accuracy: 0.5439\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5439\cf1\highlight2 
\par \cf0\highlight0 [0.09375, 0.07994186046511631, 0.05850290697674421, 0.03924418604651159]\cf1\highlight2 
\par \cf0\highlight0 [early_bird_30] Find EB!!!!!!!!!, epoch: 12\cf1\highlight2 
\par 
\par \cf0\highlight0 Saving the new best model at epoch EB-30-12...!\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 19/20 | Loss: 0.0024524785888691745 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 13 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0018043751814492191\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.6398197213808696 | Avg Test Accuracy: 0.5275\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5439\cf1\highlight2 
\par \cf0\highlight0 [0.0879360465116279, 0.06722383720930236, 0.05704941860465118, 0.04505813953488369]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):0023816213943064213 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 392, in _getdecoder\cf1\highlight2 
\par \cf0\highlight0     decoder = DECODERS[decoder_name]\cf1\highlight2 
\par \cf0\highlight0 KeyError: 'raw'\cf1\highlight2 
\par 
\par \cf0\highlight0 During handling of the above exception, another exception occurred:\cf1\highlight2 
\par 
\par \cf0\highlight0 Traceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 281, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 202, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 119, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 115, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     img = Image.fromarray(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2974, in fromarray\cf1\highlight2 
\par \cf0\highlight0     return frombuffer(mode, size, obj, "raw", rawmode, 0, 1)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2901, in frombuffer\cf1\highlight2 
\par \cf0\highlight0     return frombytes(mode, size, data, decoder_name, args)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 2843, in frombytes\cf1\highlight2 
\par \cf0\highlight0     im.frombytes(data, decoder_name, args)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 793, in frombytes\cf1\highlight2 
\par \cf0\highlight0     d = _getdecoder(self.mode, decoder_name, args)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/PIL/Image.py", line 392, in _getdecoder\cf1\highlight2 
\par \cf0\highlight0     decoder = DECODERS[decoder_name]\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epochs=100       0 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #81 | Epoch: 19/20 | Loss: 0.2595025251309077 | Acc: 1.092\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 0...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.013281694402297336\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.976392822387891 | Avg Test Accuracy: 0.2973\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2973\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.020141394808888435 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0071472254713686794\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.154116126207205 | Avg Test Accuracy: 0.1764\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2973\cf1\highlight2 
\par \cf0\highlight0 Client #81 | Epoch: 19/20 | Loss: 0.009592001947263876 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 3 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.004931146036057422\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.0534125444216604 | Avg Test Accuracy: 0.2352\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2973\cf1\highlight2 
\par \cf0\highlight0 Client #45 | Epoch: 19/20 | Loss: 0.006699346161137025 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 3...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 4 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.00378209280296384\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.4701797778789816 | Avg Test Accuracy: 0.3281\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3281\cf1\highlight2 
\par \cf0\highlight0 [0.6998546511627908, 0.19077034883720934, 0.1329941860465116, 0.08066860465116277]\cf1\highlight2 
\par \cf0\highlight0 Client #48 | Epoch: 19/20 | Loss: 0.005523786259194215 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 4...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 5 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0030783915328793225\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.2674458668782163 | Avg Test Accuracy: 0.3702\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.3702\cf1\highlight2 
\par \cf0\highlight0 [0.20203488372093026, 0.1544331395348837, 0.10755813953488369, 0.07303779069767447]\cf1\highlight2 
\par \cf0\highlight0 Client #58 | Epoch: 19/20 | Loss: 0.004816076019778848 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 5...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 6 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.002602394459018897\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.089716822673113 | Avg Test Accuracy: 0.4054\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4054\cf1\highlight2 
\par \cf0\highlight0 [0.16533430232558144, 0.11773255813953487, 0.09484011627906974, 0.0683139534883721]\cf1\highlight2 
\par \cf0\highlight0 Client #70 | Epoch: 19/20 | Loss: 0.003988254039237897 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 6...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 7 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0022584722146192296\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.9458312972998009 | Avg Test Accuracy: 0.4271\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4271\cf1\highlight2 
\par \cf0\highlight0 [0.13154069767441856, 0.11046511627906974, 0.08502906976744184, 0.06613372093023251]\cf1\highlight2 
\par \cf0\highlight0 Client #31 | Epoch: 19/20 | Loss: 0.0034876930682609477 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 7...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 8 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001997892836516257\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.8093470335006714 | Avg Test Accuracy: 0.4685\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.4685\cf1\highlight2 
\par \cf0\highlight0 [0.1191860465116279, 0.09738372093023251, 0.0839389534883721, 0.05450581395348841]\cf1\highlight2 
\par \cf0\highlight0 Client #53 | Epoch: 19/20 | Loss: 0.003052864223718643 | Acc: 1.00\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 8...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 9 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001792950311188448\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5359808603922527 | Avg Test Accuracy: 0.5294\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5294\cf1\highlight2 
\par \cf0\highlight0 [0.10901162790697672, 0.09629360465116277, 0.07194767441860461, 0.05305232558139539]\cf1\highlight2 
\par \cf0\highlight0 Client #35 | Epoch: 19/20 | Loss: 0.0029453691095113754 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 10 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.001627669742660752\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.5936164810107305 | Avg Test Accuracy: 0.5277\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5294\cf1\highlight2 
\par \cf0\highlight0 [0.09883720930232553, 0.07885174418604646, 0.06540697674418605, 0.04796511627906974]\cf1\highlight2 
\par \cf0\highlight0 [early_bird_30] Foundd EB!!!!!!!!!, epoch: 10\cf1\highlight2 
\par 
\par \cf0\highlight0 Saving Early Bird checkpoint for epoch EB-30-10...!\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #21 | Epoch: 19/20 | Loss: 0.0021343311915795007 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 10...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 11 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0014914729222866958\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.4330960420461802 | Avg Test Accuracy: 0.5574\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5574\cf1\highlight2 
\par \cf0\highlight0 [0.09375, 0.07994186046511631, 0.06867732558139539, 0.04796511627906974]\cf1\highlight2 
\par \cf0\highlight0 Client #80 | Epoch: 19/20 | Loss: 0.0023451042749608555 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 11...!\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Results after 12 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.0013769746046616797\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 1.4156199617263598 | Avg Test Accuracy: 0.5674\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.5674\cf1\highlight2 
\par \cf0\highlight0 [0.08648255813953487, 0.07776162790697672, 0.06395348837209303, 0.04578488372093026]\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):1369362852225701 | Acc: 1.0040\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 281, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 202, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 119, in _train_client\cf1\highlight2 
\par \cf0\highlight0     for idx, (data, target) in enumerate(train_loader):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 681, in __next__\cf1\highlight2 
\par \cf0\highlight0     data = self._next_data()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/dataloader.py", line 721, in _next_data\cf1\highlight2 
\par \cf0\highlight0     data = self._dataset_fetcher.fetch(index)  # may raise StopIteration\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in fetch\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/utils/data/_utils/fetch.py", line 49, in <listcomp>\cf1\highlight2 
\par \cf0\highlight0     data = [self.dataset[idx] for idx in possibly_batched_index]\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/data/mnist.py", line 21, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     x, y = super().__getitem__(index)  # This directly uses the parent class method\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/datasets/cifar.py", line 118, in __getitem__\cf1\highlight2 
\par \cf0\highlight0     img = self.transform(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 94, in __call__\cf1\highlight2 
\par \cf0\highlight0     img = t(img)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torch/nn/modules/module.py", line 1130, in _call_impl\cf1\highlight2 
\par \cf0\highlight0     return forward_call(*input, **kwargs)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/transforms.py", line 269, in forward\cf1\highlight2 
\par \cf0\highlight0     return F.normalize(tensor, self.mean, self.std, self.inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional.py", line 360, in normalize\cf1\highlight2 
\par \cf0\highlight0     return F_t.normalize(tensor, mean=mean, std=std, inplace=inplace)\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/.conda/envs/f_avg/lib/python3.9/site-packages/torchvision/transforms/functional_tensor.py", line 956, in normalize\cf1\highlight2 
\par \cf0\highlight0     mean = mean.view(-1, 1, 1)\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epochs=100       0 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 0/20 | Loss: 3.0658727486928306 | Acc: 0.116\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 1/20 | Loss: 3.0257302125295005 | Acc: 0.186\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 2/20 | Loss: 2.988839626312256 | Acc: 0.194\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 3/20 | Loss: 2.9509769280751548 | Acc: 0.254\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 4/20 | Loss: 2.8906397024790444 | Acc: 0.284\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 5/20 | Loss: 2.8231178919474282 | Acc: 0.294\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 6/20 | Loss: 2.727757215499878 | Acc: 0.316\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 7/20 | Loss: 2.6070960760116577 | Acc: 0.396\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 8/20 | Loss: 2.4570329984029136 | Acc: 0.514\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 9/20 | Loss: 2.321947693824768 | Acc: 0.606\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 10/20 | Loss: 2.107426166534424 | Acc: 0.722\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 11/20 | Loss: 1.8841616312662761 | Acc: 0.794\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 12/20 | Loss: 1.6496710777282715 | Acc: 0.842\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 13/20 | Loss: 1.4072470267613728 | Acc: 0.912\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 14/20 | Loss: 1.1565218170483906 | Acc: 0.954\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 15/20 | Loss: 0.9092747171719869 | Acc: 0.996\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 16/20 | Loss: 0.6908115049203237 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 17/20 | Loss: 0.5019208490848541 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 18/20 | Loss: 0.3540220707654953 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #82 | Epoch: 19/20 | Loss: 0.24082665145397186 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 0/20 | Loss: 3.0702993075052896 | Acc: 0.088\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 1/20 | Loss: 3.0306480725606284 | Acc: 0.186\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 2/20 | Loss: 2.9863924185434976 | Acc: 0.214\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 3/20 | Loss: 2.9448585510253906 | Acc: 0.252\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 4/20 | Loss: 2.881153424580892 | Acc: 0.272\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 5/20 | Loss: 2.812901576360067 | Acc: 0.286\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 6/20 | Loss: 2.7201363245646157 | Acc: 0.314\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 7/20 | Loss: 2.621299703915914 | Acc: 0.348\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 8/20 | Loss: 2.481979807217916 | Acc: 0.398\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 9/20 | Loss: 2.317182103792826 | Acc: 0.494\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 10/20 | Loss: 2.124409317970276 | Acc: 0.568\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 11/20 | Loss: 1.8823315699895222 | Acc: 0.69\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 12/20 | Loss: 1.6202330191930134 | Acc: 0.78\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 13/20 | Loss: 1.3502943118413289 | Acc: 0.866\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 14/20 | Loss: 1.0831684668858845 | Acc: 0.924\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 15/20 | Loss: 0.8262755672136942 | Acc: 0.97\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 16/20 | Loss: 0.589000403881073 | Acc: 0.998\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 17/20 | Loss: 0.40599383413791656 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 18/20 | Loss: 0.2705776244401932 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #36 | Epoch: 19/20 | Loss: 0.18254575381676355 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 0/20 | Loss: 3.0742765267690024 | Acc: 0.092\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 1/20 | Loss: 3.0393381118774414 | Acc: 0.22\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 2/20 | Loss: 2.9943435192108154 | Acc: 0.308\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 3/20 | Loss: 2.953352769215902 | Acc: 0.26\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 4/20 | Loss: 2.907155990600586 | Acc: 0.264\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 5/20 | Loss: 2.8526171843210855 | Acc: 0.29\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 6/20 | Loss: 2.7700462341308594 | Acc: 0.358\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 7/20 | Loss: 2.652564207712809 | Acc: 0.42\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 8/20 | Loss: 2.519174575805664 | Acc: 0.514\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 9/20 | Loss: 2.3746471405029297 | Acc: 0.578\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 10/20 | Loss: 2.1758607625961304 | Acc: 0.68\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 11/20 | Loss: 1.9314405918121338 | Acc: 0.762\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 12/20 | Loss: 1.6622737646102905 | Acc: 0.822\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 13/20 | Loss: 1.3693219820658367 | Acc: 0.864\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 14/20 | Loss: 1.0616138180096943 | Acc: 0.912\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 15/20 | Loss: 0.7880075971285502 | Acc: 0.98\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 16/20 | Loss: 0.55337326725324 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 17/20 | Loss: 0.3767017175753911 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 18/20 | Loss: 0.2518629729747772 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #27 | Epoch: 19/20 | Loss: 0.17007491240898767 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 0/20 | Loss: 3.0733227729797363 | Acc: 0.11\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 1/20 | Loss: 3.0250330766042075 | Acc: 0.234\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 2/20 | Loss: 2.9867289861043296 | Acc: 0.182\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 3/20 | Loss: 2.942150036493937 | Acc: 0.198\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 4/20 | Loss: 2.9205915133158364 | Acc: 0.206\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 5/20 | Loss: 2.8814427852630615 | Acc: 0.272\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 6/20 | Loss: 2.795123736063639 | Acc: 0.4\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 7/20 | Loss: 2.706402818361918 | Acc: 0.526\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 8/20 | Loss: 2.5659311612447104 | Acc: 0.612\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 9/20 | Loss: 2.3923343817392984 | Acc: 0.682\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 10/20 | Loss: 2.197194536526998 | Acc: 0.734\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 11/20 | Loss: 1.9484028816223145 | Acc: 0.792\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 12/20 | Loss: 1.6691557963689168 | Acc: 0.832\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 13/20 | Loss: 1.3644920984903972 | Acc: 0.87\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 14/20 | Loss: 1.0599185824394226 | Acc: 0.93\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 15/20 | Loss: 0.7586425542831421 | Acc: 0.982\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 16/20 | Loss: 0.5302765866120657 | Acc: 0.994\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 17/20 | Loss: 0.36002251505851746 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 18/20 | Loss: 0.24482950568199158 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #49 | Epoch: 19/20 | Loss: 0.16389418641726175 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 0/20 | Loss: 3.06292994817098 | Acc: 0.122\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 1/20 | Loss: 3.023479779561361 | Acc: 0.18\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 2/20 | Loss: 2.9773598512013755 | Acc: 0.21\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 3/20 | Loss: 2.93037478129069 | Acc: 0.196\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 4/20 | Loss: 2.858818213144938 | Acc: 0.226\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 5/20 | Loss: 2.7765731811523438 | Acc: 0.284\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 6/20 | Loss: 2.7116486231486 | Acc: 0.354\cf1\highlight2 
\par 
\par \cf0\highlight0 Client #54 | Epoch: 7/20 | Loss: 2.6725459893544516 | Acc: 0.448\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 281, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 202, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 128, in _train_client\cf1\highlight2 
\par \cf0\highlight0     epoch_loss += loss.item()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par \cf0\highlight0 ^C\cf1\highlight2 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epochs=100       0 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 0/20 | Loss: 3.077029228210449 | Acc: 0.08\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 1/20 | Loss: 3.0429760615030923 | Acc: 0.168\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 2/20 | Loss: 3.0005107720692954 | Acc: 0.164\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 3/20 | Loss: 2.963639497756958 | Acc: 0.17\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 4/20 | Loss: 2.9104517300923667 | Acc: 0.182\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 5/20 | Loss: 2.848832607269287 | Acc: 0.204\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 6/20 | Loss: 2.76737372080485 | Acc: 0.348\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 7/20 | Loss: 2.6780622800191245 | Acc: 0.544\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 8/20 | Loss: 2.566980163256327 | Acc: 0.598\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 9/20 | Loss: 2.409045378367106 | Acc: 0.648\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 10/20 | Loss: 2.2247258027394614 | Acc: 0.728\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 11/20 | Loss: 2.0219974517822266 | Acc: 0.772\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 12/20 | Loss: 1.7817551294962566 | Acc: 0.806\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 13/20 | Loss: 1.5239176352818806 | Acc: 0.842\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 14/20 | Loss: 1.2769928574562073 | Acc: 0.874\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 15/20 | Loss: 1.0461711486180623 | Acc: 0.894\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 16/20 | Loss: 0.8490280310312907 | Acc: 0.926\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 17/20 | Loss: 0.6723399261633555 | Acc: 0.962\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 18/20 | Loss: 0.5227285524209341 | Acc: 0.984\cf1\highlight2 
\par 
\par 
\par 
\par \cf0\highlight0 Client #40 | Epoch: 19/20 | Loss: 0.394866943359375 | Acc: 1.0\cf1\highlight2 
\par 
\par \cf0\highlight0 ^CTraceback (most recent call last):\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 282, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 203, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 128, in _train_client\cf1\highlight2 
\par \cf0\highlight0     epoch_loss += loss.item()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$ python fed_avg_early_bird_.py --batch_size=10 --frac=0.1 --lr=0.01 --n_client_epochs=20 --n_clients=100 --n_epochs=100       0 --n_shards=200 --non_iid=0 --model="vgg"\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Files already downloaded and verified\cf1\highlight2 
\par \cf0\highlight0 Client #46 | Epoch: 19/20 | Loss: 0.37039348979791004 | Acc: 0.998\cf1\highlight2 
\par \cf0\highlight0 Saving the new best model at epoch 1...!\cf1\highlight2 
\par 
\par 
\par \cf0\highlight0 Results after 1 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.015158333418269953\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 2.058005718084482 | Avg Test Accuracy: 0.2669\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2669\cf1\highlight2 
\par \cf0\highlight0 Client #89 | Epoch: 19/20 | Loss: 0.02009954396635294 | Acc: 1.00\cf1\highlight2 
\par 
\par \cf0\highlight0 Results after 2 rounds of training:\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Training Loss: 0.008110188881400974\cf1\highlight2 
\par \cf0\highlight0 ---> Avg Test Loss: 3.4871146189860807 | Avg Test Accuracy: 0.1688\cf1\highlight2 
\par 
\par \cf0\highlight0 Best accuracy: 0.2669\cf1\highlight2 
\par \cf0\highlight0 ^CTraceback (most recent call last):010963981039822102 | Acc: 1.0\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 282, in <module>\cf1\highlight2 
\par \cf0\highlight0     fed_avg.train()\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 203, in train\cf1\highlight2 
\par \cf0\highlight0     client_model, opt_state, client_loss = self._train_client(\cf1\highlight2 
\par \cf0\highlight0   File "/home1/khoshino/FedAvg/fed_avg_early_bird_.py", line 128, in _train_client\cf1\highlight2 
\par \cf0\highlight0     epoch_loss += loss.item()\cf1\highlight2 
\par \cf0\highlight0 KeyboardInterrupt\cf1\highlight2 
\par 
\par \cf0\highlight0 (f_avg) [khoshino@e21-16 FedAvg]$\cf1\highlight2 
\par \pard\cf0\highlight0\f2 
\par }
 